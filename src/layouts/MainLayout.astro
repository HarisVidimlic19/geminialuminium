---
interface Props {
	title: string;
	description?: string;
	keywords?: string;
}

const { title, description = "Professional exterior home improvements including eavestrough, siding, and gutter services in the Greater Toronto Area.", keywords = "home improvements, eavestrough, siding, gutters, exterior renovation, Toronto" } = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const baseUrl = import.meta.env.BASE_URL;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content={description} />
		<meta name="keywords" content={keywords} />
		<link rel="icon" type="image/png" href={`${baseUrl}/favicon.png`} />
		<link rel="canonical" href={canonicalURL} />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		
		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={canonicalURL} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		
		<title>{title} | Gemini Home Improvements</title>

		<!-- Google Analytics 4 - FREE -->
		<!-- Replace G-XXXXXXXXXX with your actual Google Analytics Measurement ID -->
		<script is:inline async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
		<script is:inline>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'G-XXXXXXXXXX');
		</script>
	</head>
	<body>
		<header class="header">
			<div class="container">
				<nav>
					<a href={baseUrl} class="logo">
						<img src={`${baseUrl}/logo.svg`} alt="Gemini Home Improvements Logo" style="height: 60px;" />
					</a>
					<ul class="nav-menu">
						<li><a href={baseUrl}>Home</a></li>
						<li><a href={`${baseUrl}/services/`}>Services</a></li>
						<li><a href={`${baseUrl}/projects/`}>Projects</a></li>
						<li><a href={`${baseUrl}/team/`}>Owner</a></li>
						<li><a href={`${baseUrl}/about/`}>About</a></li>
						<li><a href={`${baseUrl}/contact/`}>Contact</a></li>
					</ul>
					<button class="mobile-menu-toggle" aria-label="Toggle menu">
						<span></span>
						<span></span>
						<span></span>
					</button>
				</nav>
			</div>
		</header>

		<main>
			<slot />
		</main>

		<footer class="footer">
			<div class="container">
				<div class="footer-content">
					<div class="footer-section">
						<h3>Gemini Home Improvements</h3>
						<p>Professional exterior renovation services for over 15 years.</p>
					</div>
					<div class="footer-section">
						<h4>Quick Links</h4>
						<ul>
							<li><a href={`${baseUrl}/services/`}>Services</a></li>
							<li><a href={`${baseUrl}/projects/`}>Projects</a></li>
							<li><a href={`${baseUrl}/contact/`}>Contact</a></li>
						</ul>
					</div>
					<div class="footer-section">
						<h4>Contact</h4>
						<p>Email: <a href="#" id="footer-email" class="contact-link">Loading...</a></p>
						<p>Phone: <span id="footer-phone" class="contact-display">Loading...</span></p>
					</div>
				</div>
				<div class="footer-bottom">
					<p>&copy; {new Date().getFullYear()} Gemini Home Improvements. All rights reserved.</p>
				</div>
			</div>
		</footer>

		<style is:global>
			@import '../styles/global.css';
		</style>
		
		<script>
			// Mobile menu toggle
			const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
			const navMenu = document.querySelector('.nav-menu');
			
			mobileMenuToggle?.addEventListener('click', () => {
				navMenu?.classList.toggle('active');
				mobileMenuToggle.classList.toggle('active');
			});

			// Auto-render obfuscated contact info on page load (anti-scraping protection)
			document.addEventListener('DOMContentLoaded', () => {
				// Obfuscated email: geminihi@outlook.com (Base64)
				const obfuscatedEmail = atob('Z2VtaW5paGlAb3V0bG9vay5jb20=');
				const footerEmail = document.getElementById('footer-email');
				if (footerEmail) {
					footerEmail.setAttribute('href', 'mailto:' + obfuscatedEmail);
					footerEmail.textContent = obfuscatedEmail;
				}

				// Obfuscated phone: 5551234567 (Character codes) - PLACEHOLDER, UPDATE WITH REAL NUMBER
                const phoneCodes = [52,49,54,51,53,55,55,55,49,54];
				const phone = String.fromCharCode(...phoneCodes);
				const formatted = phone.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
				const footerPhone = document.getElementById('footer-phone');
				if (footerPhone) {
					footerPhone.textContent = formatted;
				}
			});
		</script>
	</body>
</html>
